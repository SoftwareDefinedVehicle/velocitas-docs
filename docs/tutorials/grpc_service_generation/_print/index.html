<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" type="text/css" href="//www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
<link rel="stylesheet" type="text/css" href="/velocitas//css/overwrite.css" />
<script src="//www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>

<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5WLCZXC');
</script>


<meta name="generator" content="Hugo 0.123.3">
<link rel="canonical" type="text/html" href="/velocitas/docs/tutorials/grpc_service_generation/">
<link rel="alternate" type="application/rss&#43;xml" href="/velocitas/docs/tutorials/grpc_service_generation/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/velocitas/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/velocitas/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/velocitas/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/velocitas/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/velocitas/favicons/android-192x192.png" sizes="192x192">

<title>gRPC service generation | Velocitas</title>
<meta name="description" content="Learn how to generate and fill your own gRPC services.">
<meta property="og:title" content="gRPC service generation" />
<meta property="og:description" content="Learn how to generate and fill your own gRPC services.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/velocitas/docs/tutorials/grpc_service_generation/" />

<meta itemprop="name" content="gRPC service generation">
<meta itemprop="description" content="Learn how to generate and fill your own gRPC services.
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="gRPC service generation"/>
<meta name="twitter:description" content="Learn how to generate and fill your own gRPC services.
"/>
<link rel="preload" href="/velocitas/scss/main.min.15e30afa5287f4afeaa31c33b53a188487e7acdf133420f326f9494f34fb9785.css" as="style" integrity="sha256-FeMK&#43;lKH9K/qoxwztToYhIfnrN8TNCDzJvlJTzT7l4U=" crossorigin="anonymous">
<link href="/velocitas/scss/main.min.15e30afa5287f4afeaa31c33b53a188487e7acdf133420f326f9494f34fb9785.css" rel="stylesheet" integrity="sha256-FeMK&#43;lKH9K/qoxwztToYhIfnrN8TNCDzJvlJTzT7l4U=" crossorigin="anonymous">
<script
  src=/velocitas/js/jquery-3.6.0.min.js
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script defer
  src="/velocitas/js/lunr-2.3.9.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/velocitas/"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="180mm" height="40mm" style="clip-rule:evenodd;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" viewBox="0 0 7086.6144 1574.8032" id="svg983" sodipodi:docname="logo.svg" inkscape:version="1.0 (4035a4f, 2020-05-01)"><sodipodi:namedview inkscape:document-rotation="0" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1080" id="namedview985" showgrid="false" showguides="false" units="mm" inkscape:zoom=".69602273" inkscape:cx="408" inkscape:cy="528" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="Layer_x0020_1"/><defs id="defs967"><style id="style956">.fil5{fill:#24b2e4}.fil4{fill:#2e95c9}.fil3{fill:#2477b6}.fil2{fill:#2c5aa0}.fil1{fill:#364b95}.fil0{fill:url(#id0);fill-rule:nonzero}</style><linearGradient id="id0" gradientUnits="userSpaceOnUse" x1="3149.4299" y1="5635.5898" x2="7771.9399" y2="5635.5898"><stop offset="0" style="stop-opacity:1;stop-color:#2B6FB5" id="stop958"/><stop offset=".870588" style="stop-opacity:1;stop-color:#7DC5ED" id="stop960"/><stop offset=".988235" style="stop-opacity:1;stop-color:#7DC5ED" id="stop962"/><stop offset="1" style="stop-opacity:1;stop-color:#7DC5ED" id="stop964"/></linearGradient></defs><g id="Layer_x0020_1" transform="matrix(0.98370981,0,0,0.98370981,-626.40511,-4616.899)"><path class="fil0" d="m3395.11 6027.9h147.19l246.79-709.92h-116.2l-203.63 611.98-205.28-611.98h-114.54l245.68 709.92zm968.32-244.57v0-170.98c0-99.6-76.36-154.37-183.7-154.37h-131.69c-107.35.0-183.7 54.78-183.7 154.37v261.17c0 99.6 76.36 154.38 183.7 154.38h315.39v-82.44h-353.02c-28.22.0-37.63-18.26-37.63-47.59v-114.54zm-108.45-83v0h-282.2v-112.88c0-22.13 9.41-47.03 37.63-47.03h206.94c28.22.0 37.63 24.9 37.63 47.03zm258.95 327.57v0h108.45v-784.62h-108.45zm760.83-415.55v0c0-99.6-65.29-154.37-171.53-154.37h-158.81c-106.24.0-172.09 54.78-172.09 154.37v261.17c0 99.6 65.85 154.38 172.09 154.38h158.81c106.24.0 171.53-54.78 171.53-154.38zm-393.97 275.01v0-288.84c0-42.06 12.17-58.1 48.69-58.1h188.69c36.52.0 48.14 16.04 48.14 58.1v288.84c0 41.5-11.62 58.1-48.14 58.1h-188.69c-36.52.0-48.69-16.6-48.69-58.1zm631.35.0v0-288.84c0-42.06 11.62-58.1 48.14-58.1h272.79v-82.44h-256.19c-107.35.0-173.19 54.78-173.19 154.37v261.17c0 99.6 65.85 154.38 173.19 154.38h256.19v-82.44h-272.79c-36.52.0-48.14-16.6-48.14-58.1zm460.93 140.54v0h107.9v-569.93h-107.9zM5962 5362.25v0h130.03V5243.28H5962zm621.94 178.17v0-82.44h-168.76v-139.99h-76.36l-32.09 139.99h-85.77v82.44h85.77v332c0 96.28 54.78 155.48 180.39 155.48h96.83v-82.44h-120.63c-41.5.0-48.14-21.58-48.14-61.42v-343.61h168.76zm107.35 333.1v0c0 99.6 65.3 154.38 172.64 154.38h33.2c83.56.0 143.87-2.21 169.87-65.29v65.29h107.35v-415.55c0-99.6-76.36-154.37-183.71-154.37h-241.8v82.44h280.54c27.67.0 37.63 18.26 37.63 47.03v95.72h-203.07c-107.35.0-172.64 54.78-172.64 154.93v35.41zm108.45 13.83v0-63.63c0-39.29 10.52-55.89 42.61-57.55H7067v141.65c-3.32 26.56-13.28 37.63-43.16 37.63h-175.96c-36.52.0-48.14-16.6-48.14-58.1zm863.75 27.67v0c0 22.69-11.62 30.43-48.14 30.43H7324.3v82.44h275c107.35.0 172.64-54.78 172.64-154.38v-40.94c0-68.61-47.03-90.19-146.63-113.99-80.78-19.37-101.26-26.56-203.07-51.46v-96.83c0-22.13 11.62-29.88 48.14-29.88h282.2v-82.44h-266.15c-107.34.0-172.64 54.78-172.64 154.37v37.63c0 64.19 43.71 89.08 132.8 109.56 106.8 24.9 151.61 36.52 216.91 50.35v105.13z" id="path970" style="fill:url(#id0)"/><path class="fil1" d="m728.06 5018.07c722.09-309.86 1087.3 423.3 1320.24 889.75 88.54 177.62 156.59 313.19 195.88 317.61 67.5 8.3 132.24-294.37 240.7-1228.94l85.77 7.19C2455 5996.35 2361.49 6315.07 2233.12 6300.13 2145.14 6289.62 2069.33 6137.45 1969.73 5937.7c-219.12-438.78-562.74-1127.13-1203.49-852.12z" id="path972"/><path class="fil2" d="m900.14 4963.85c686.68-298.8 1022 350.81 1244.44 781.3 87.43 168.77 155.49 301.01 202.52 309.31 74.7 12.17 156.04-257.3 299.35-1107.76l85.22 10.51c-153.28 909.67-266.15 1193.53-400.61 1170.84-90.74-15.49-167.11-163.23-265.04-352.47C1857.97 5373.32 1544.78 4766.86 938.89 5030.8l-38.73-66.95z" id="path974"/><path class="fil3" d="m1056.18 4905.75c651.27-287.18 957.26 282.2 1168.63 675.61 85.21 158.25 153.27 285.52 207.5 298.24 82.45 18.81 180.94-216.35 359.11-986.03l84.66 14.39c-192.56 828.88-324.8 1076.78-465.35 1044.13-93.51-21.58-169.32-163.23-263.94-339.19-195.88-364.64-479.74-892.52-1051.88-640.2z" id="path976"/><path class="fil4" d="m1238.22 4844.88c616.96-276.66 894.18 216.35 1094.49 572.7 80.79 144.42 148.29 263.94 209.16 282.75 90.19 28.22 205.29-171.53 421.09-863.74l83.55 19.37c-234.61 751.97-386.78 961.13-533.96 915.2-93.51-29.33-167.66-161.57-257.3-320.93-183.71-327.57-438.79-780.75-977.74-538.39l-39.29-66.95z" id="path978"/><path class="fil5" d="m1406.99 4784.02c583.76-266.7 832.76 153.83 1020.89 471.99 75.25 127.27 139.99 236.83 205.28 263.38 99.05 40.94 231.85-120.07 489.15-740.91l80.79 25.45c-281.65 680.59-453.73 847.15-607 783.51-91.3-37.63-162.13-157.7-244.57-297.13-171.54-289.39-397.85-671.74-904.7-439.9l-39.84-66.4z" id="path980"/></g></svg></span><span class="navbar-brand__name">Velocitas</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/velocitas/docs/"><span>Documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/eclipse-velocitas" target="_blank" rel="noopener"><span>GitHub</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/velocitas/offline-search-index.55b1b0729299b9336b4728761b62b430.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/velocitas/docs/tutorials/grpc_service_generation/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">gRPC service generation</h1>
<div class="lead">Learn how to generate and fill your own gRPC services.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-897cdbf91f70f82bfc4621234c28a548">Create a server</a></li>


    
  
    
    
	
<li>2: <a href="#pg-b722dae253f4894783e6d445959bc8c0">Create a client</a></li>


    
  

    </ul>


<div class="content">
      <p>This tutorial shows how to generate a basic gRPC service like a seat service. For this example the proto file at 

<a href="https://raw.githubusercontent.com/eclipse-kuksa/kuksa-incubation/0.4.0/seat_service/proto/sdv/edge/comfort/seats/v1/seats.proto" target="_blank" rel="noopener">https://raw.githubusercontent.com/eclipse-kuksa/kuksa-incubation/0.4.0/seat_service/proto/sdv/edge/comfort/seats/v1/seats.proto</a>
 is used.</p>
<p>All files included from <code>services/seats</code> are auto-generated and added to the app project as Conan dependency.
For writing a complete gRPC service you need two velocitas apps/projects.
One is implementing a client and the other one is for providing the server.</p>
<h2 id="networking">Networking</h2>
<p>The examples shown in this tutorial are based on three components running:</p>
<ul>
<li>A client using the API defined in the proto file</li>
<li>A server providing the API and communicating with Databroker to read or modify datapoints</li>
<li>A 

<a href="https://github.com/eclipse-kuksa/kuksa-databroker" target="_blank" rel="noopener">Kuksa Databroker</a>
.</li>
</ul>
<p>As a Velocitas developer you may use the 

<a href="https://github.com/eclipse-velocitas/devenv-runtimes" target="_blank" rel="noopener">Velocitas devenv-runtimes</a>
 to deploy and run the Databroker instance, but it is also possible to connect to a Databroker running on localhost.
The following setup was used for the examples:</p>
<ul>
<li>One Velocitas Devcontainer running the Client, based on the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">Vehicle App C++ Template</a>
.</li>
<li>One Velocitas Devcontainer running the Server, based on the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">Vehicle App C++ Template</a>
.</li>
<li>Databroker running on localhost.</li>
</ul>
<p>For this to work the <code>.devcontainer/devcontainer.json</code> was changed.
In the setup <code>--network=host</code> was added to allow the containers to use the host network.
For the server <code>forwardPorts&quot;: [ 5555 ]</code> was additionally used to forward port 5555.</p>
<pre tabindex="0"><code>    &#34;forwardPorts&#34;: [ 5555 ],
	&#34;runArgs&#34;: [
		&#34;--init&#34;,
		&#34;--privileged&#34;,
		&#34;--cap-add=SYS_PTRACE&#34;,
		&#34;--network=host&#34;,
		&#34;--security-opt&#34;,
		&#34;seccomp=unconfined&#34;
	],
</code></pre><p>Note that changes to <code>.devcontainer/devcontainer.json</code> may be overwritten when <code>velocitas sync</code> is performed.</p>
<h2 id="running-the-examples">Running the examples</h2>
<p>To run the examples the following actions need to be performed in the shown order:</p>
<ul>
<li>Databroker needs to be started.
If using a Databroker on host, make sure that it is compatible with the Velocitas version you are using.
The catalog used must also be compatible with the signals used in the example.</li>
<li>Set the current value of <code>Vehicle.Cabin.Seat.Row1.DriverSide.Position</code> to a valid value, for example 12, using a Databroker Client (

<a href="https://pypi.org/project/kuksa-client/" target="_blank" rel="noopener">Kuksa Python Client</a>
 or 

<a href="https://github.com/eclipse-kuksa/kuksa-databroker" target="_blank" rel="noopener">Databroker CLI</a>
).</li>
<li>Start the server.</li>
<li>Start the client.</li>
<li>Verify that no (unexpected) errors are reported.</li>
<li>Use the Databroker Client to verify that the target value of <code>Vehicle.Cabin.Seat.Row1.DriverSide.Position</code> has been set to 75.</li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-897cdbf91f70f82bfc4621234c28a548">1 - Create a server</h1>
    <div class="lead">Learn how to create a server for a service definition.</div>
	<h1 id="introduction">Introduction</h1>
<p>This example assumes that you have used the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">Velocitas App C++ Template</a>
 to create a new repository and now want to modify it to be a grpc service server.
The example files can also be found in the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-sdk/tree/main/examples/grpc_server" target="_blank" rel="noopener">Vehicle App C++ SDK Github repository</a>
.</p>
<h2 id="velocitas-components">Velocitas components</h2>
<p>Dependning on how you intend to deploy the Application and Databroker the number of Velocitas components required varies.
Below is the minimum set needed in <code>.velocitas.json</code> if deploying Databroker on localhost.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;components&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;devcontainer-setup&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;vehicle-signal-interface&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;grpc-interface-support&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;sdk-installer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;build-system&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><h2 id="app-configuration">App configuration</h2>
<p>In the <code>AppManifest.json</code> you need to specify that your server will provide the interfaces defined in the proto file.
If it requires access to signals from the Databroker, they must also be specified.
In this example the server declares to provide the interfaces from the Seats service defined in <code>seats.proto</code> and that it needs write access to the VSS signal <code>Vehicle.Cabin.Seat.Row1.DriverSide.Position</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;manifestVersion&#34;</span><span style="color:#a40000">:</span> <span style="color:#4e9a06">&#34;v3&#34;</span><span style="color:#a40000">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#a40000">:</span> <span style="color:#4e9a06">&#34;SampleApp&#34;</span><span style="color:#a40000">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;interfaces&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;grpc-interface&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;config&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;src&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;https://raw.githubusercontent.com/eclipse-kuksa/kuksa-incubation/0.4.0/seat_service/proto/sdv/edge/comfort/seats/v1/seats.proto&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;provided&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;vehicle-signal-interface&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;config&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;src&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;https://github.com/COVESA/vehicle_signal_specification/releases/download/v4.0/vss_rel_4.0.json&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;datapoints&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;required&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#204a87;font-weight:bold">&#34;path&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Vehicle.Cabin.Seat.Row1.DriverSide.Position&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#204a87;font-weight:bold">&#34;access&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;write&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#a40000">}</span>
</span></span></code></pre></div><h2 id="file-generation">File Generation</h2>
<p>When rebuilding the devcontainer with the configuration above two files will be automatically created:</p>
<ul>
<li><code>SeatsServiceImpl.cpp</code></li>
<li><code>SeatsServiceImpl.h</code></li>
</ul>
<p>They contain the stubs for the server. You still need to fill in the actual implementation of the services.</p>
<h2 id="seatsserviceimplh">SeatsServiceImpl.h</h2>
<p>The service will access the vehicle model, in this tutorial we manage that by adding a private class variable <code>vehicle</code> to the file <code>SeatsServiceImpl.h</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#ifndef VELOCITAS_SERVICE_IMPL_Seats_H
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#define VELOCITAS_SERVICE_IMPL_Seats_H
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;vehicle/Vehicle.hpp&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;grpc/grpc.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;services/seats/seats.grpc.pb.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">namespace</span> <span style="color:#000">velocitas</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">SeatsService</span> <span style="color:#204a87;font-weight:bold">final</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Service</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">SeatsService</span><span style="color:#000;font-weight:bold">(){};</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#ce5c00;font-weight:bold">~</span><span style="color:#000">SeatsService</span><span style="color:#000;font-weight:bold">(){};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// &lt;auto-generated&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span> <span style="color:#000">Move</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                              <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveReply</span><span style="color:#ce5c00;font-weight:bold">*</span>         <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">override</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">MoveComponent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                                       <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveComponentRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveComponentReply</span><span style="color:#ce5c00;font-weight:bold">*</span>         <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">override</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">CurrentPosition</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                                         <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionReply</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">override</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// &lt;/auto-generated&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">private</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">vehicle</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Vehicle</span> <span style="color:#000">vehicle</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#8f5902;font-style:italic">// namespace velocitas
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;SeatsServiceImpl.cpp&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#endif </span><span style="color:#8f5902;font-style:italic">// VELOCITAS_SERVICE_IMPL_Seats_H
</span></span></span></code></pre></div><h2 id="seatsserviceimplcpp">SeatsServiceImpl.cpp</h2>
<p>In the file <code>SeatsServiceImpl.cpp</code> we need to implement the services.
In this example we only implement two of them.
The example also shows basic error handling.</p>
<p>The business logic of the server is to wait for <code>Move</code> and <code>CurrentPosition</code> requests and when received just forward the request to the Databroker and return the result.
You do not need to add <code>SeatsServiceImpl.cpp</code> to <code>src/CMakeLists.txt</code> as the header includes the *.cpp file and the header file will be included in the <code>Launcher.cpp</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;SeatsServiceImpl.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;sdk/VehicleApp.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;sdk/VehicleModelContext.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;sdk/vdb/IVehicleDataBrokerClient.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">namespace</span> <span style="color:#000">velocitas</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span> <span style="color:#000">SeatsService</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Move</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                              <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveReply</span><span style="color:#ce5c00;font-weight:bold">*</span>         <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seat</span>     <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">seat</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">location</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">location</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">row</span>      <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">location</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">pos</span>      <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">location</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Got Move Request!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">vehicle</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Cabin</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row1</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DriverSide</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Position</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">position</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">base</span><span style="color:#000;font-weight:bold">())</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">await</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;OK!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">OK</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Some error!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8f5902;font-style:italic">// This could for instance happen if datapoint is not known by databroker
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#8f5902;font-style:italic">// then message will be UNKNOWN_DATAPOINT.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CANCELLED</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">errorMessage</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">AsyncException</span><span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Async Exception!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// This could typically be that Databroker is not running or not reachable
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// or that your Velocitas environment uses an API incompatible with what your Databroker
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// instance supports
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">UNAVAILABLE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span>
</span></span><span style="display:flex;"><span><span style="color:#000">SeatsService</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveComponent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                                       <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveComponentRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveComponentReply</span><span style="color:#ce5c00;font-weight:bold">*</span>         <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// This is an example of an unimplemented method
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">UNIMPLEMENTED</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span> <span style="color:#000">SeatsService</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPosition</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ServerContext</span><span style="color:#ce5c00;font-weight:bold">*</span>                                         <span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionRequest</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionReply</span><span style="color:#ce5c00;font-weight:bold">*</span>         <span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Got CurrentPosition Request!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seat</span>          <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">response</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">mutable_seat</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seat_position</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">seat</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">mutable_position</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seatPos</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">vehicle</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Cabin</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row1</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DriverSide</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Position</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">await</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Success!!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">seat_position</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_base</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">seatPos</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">OK</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">AsyncException</span><span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Async Exception!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// This could typically be that Databroker is not running or not reachable
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// or that your Velocitas environment uses an API incompatible with what your Databroker
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// instance supports
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">OK</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">InvalidValueException</span><span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Invalid Value!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// This could be given if Databroker has no current value for Position
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// (Have you set it manually using kuksa-client or databroker-cli?)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">OK</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#8f5902;font-style:italic">// namespace velocitas
</span></span></span></code></pre></div><h2 id="launchercpp">Launcher.cpp</h2>
<p>You need to have a file that that starts the server,
in this example we modify the file <code>Launcher.cpp</code> that already exist in the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">template</a>
.
It has very simple logic, it only starts the service and
waits until the service shuts down, if ever.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;SeatsServiceImpl.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;sdk/middleware/Middleware.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;services/seats/SeatsServiceServerFactory.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;vehicle/Vehicle.hpp&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;memory&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">using</span> <span style="color:#204a87;font-weight:bold">namespace</span> <span style="color:#000">velocitas</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span><span style="color:#ce5c00;font-weight:bold">**</span> <span style="color:#000">argv</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seatsImpl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">make_shared</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">SeatsService</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">velocitas</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">VehicleModelContext</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">getInstance</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">setVdbc</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">velocitas</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">IVehicleDataBrokerClient</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">createInstance</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;vehicledatabroker&#34;</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">seatServer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">SeatsServiceServerFactory</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Middleware</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">getInstance</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">seatsImpl</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seatServer</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">Wait</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Waiting!&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="building-and-running">Building and Running</h2>
<p>To (re-)build the App after changing the code you can use the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template/blob/main/build.sh" target="_blank" rel="noopener">build script</a>
.
As preparation for running you must also set two environment variables to define where the address/port of the server and the Databroker.
The environment variable needs to be set in the same terminal as used for starting the application.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./build.sh
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SDV_SEATS_ADDRESS</span><span style="color:#ce5c00;font-weight:bold">=</span>grpc://127.0.0.1:5555
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SDV_VEHICLEDATABROKER_ADDRESS</span><span style="color:#ce5c00;font-weight:bold">=</span>grpc://127.0.0.1:55555
</span></span></code></pre></div><p>If Databroker is running and has a current value for the wanted signal, then everthing shall work when the client is started.
Output similar to below is expected when client has run once.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vscode ➜ /workspaces/erik_server_241021 <span style="color:#ce5c00;font-weight:bold">(</span>main<span style="color:#ce5c00;font-weight:bold">)</span> $ build/bin/app
</span></span><span style="display:flex;"><span>2024-10-22 09:51:41, INFO  : Connecting to data broker service <span style="color:#4e9a06">&#39;vehicledatabroker&#39;</span> via <span style="color:#4e9a06">&#39;127.0.0.1:55555&#39;</span>
</span></span><span style="display:flex;"><span>2024-10-22 09:51:41, INFO  : Server sdv::edge::comfort::seats::v1::Seats listening on 127.0.0.1:5555
</span></span><span style="display:flex;"><span>Got Move Request!
</span></span><span style="display:flex;"><span>OK!
</span></span><span style="display:flex;"><span>Got CurrentPosition Request!
</span></span><span style="display:flex;"><span>Success!
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b722dae253f4894783e6d445959bc8c0">2 - Create a client</h1>
    <div class="lead">Learn how to create a client for a service definition.</div>
	<h1 id="introduction">Introduction</h1>
<p>This example assumes that you have used the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">Velocitas App C++ Template</a>
 to create a new repository and now want to modify it to be a grpc service client.
The example files can also be found in the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-sdk/tree/main/examples/grpc_client" target="_blank" rel="noopener">Vehicle App C++ SDK Github repository</a>
.</p>
<h1 id="velocitas-components">Velocitas components</h1>
<p>Depending on how you intend to deploy the Application and Databroker the number of Velocitas components required varies.
Below is the minimum set needed in <code>.velocitas.json</code> if deploying Databroker on localhost.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;components&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;devcontainer-setup&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;grpc-interface-support&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;sdk-installer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;build-system&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><h2 id="app-configuration">App configuration</h2>
<p>In the <code>AppManifest.json</code> file you need to specify which interfaces your App wants to use.
In this case it declares that it wants to use <code>Move</code> and <code>CurrentPosition</code> from the Seats service defined in <code>seats.proto</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;manifestVersion&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;v3&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;SampleApp&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;interfaces&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;grpc-interface&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;config&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;src&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;https://raw.githubusercontent.com/eclipse-kuksa/kuksa-incubation/0.4.0/seat_service/proto/sdv/edge/comfort/seats/v1/seats.proto&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;required&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;methods&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#4e9a06">&#34;Move&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;CurrentPosition&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="file-generation">File Generation</h2>
<p>When rebuilding the devcontainer with the configuration no new files will appear in your repository, but the SDK has been updated in the background so you can use it in the file containing <code>main()</code>.
You can also regenerate the SDK with the <code>(Re-)generate gRPC SDKs</code> task.</p>
<h2 id="launchercpp">Launcher.cpp</h2>
<p>You need to have a file that implements the client behavior.
In this example we modify the file <code>Launcher.cpp</code> that already exists in the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template" target="_blank" rel="noopener">template</a>
.
The logic of the example client is simple. It tries to set the target position for the seat and if it succeeds it tries to read current position.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;sdk/middleware/Middleware.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;services/seats/SeatsServiceClientFactory.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;services/seats/seats.grpc.pb.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;iostream&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">using</span> <span style="color:#204a87;font-weight:bold">namespace</span> <span style="color:#000">velocitas</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span><span style="color:#ce5c00;font-weight:bold">**</span> <span style="color:#000">argv</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// The default Velocitas Middleware class performs service discovery by
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">// environment variables.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">// For this client it expects SDV_SEATS_ADDRESS to be defined
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">// for example:
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">// export SDV_SEATS_ADDRESS=grpc://127.0.0.1:5556
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Starting &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">serviceClient</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">SeatsServiceClientFactory</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Middleware</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">getInstance</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ClientContext</span>                        <span style="color:#000">context</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveRequest</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">MoveReply</span>   <span style="color:#000">response</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Seat</span> <span style="color:#000">seat</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">SeatLocation</span> <span style="color:#000">seat_location</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seat_location</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seat_location</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Position</span> <span style="color:#000">seat_position</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seat_position</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_base</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">75.0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_allocated_location</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">seat_location</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">seat</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_allocated_position</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">seat_position</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_allocated_seat</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">seat</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">serviceClient</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">Move</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;gRPC Server returned code: &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error_code</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;gRPC error message: &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error_message</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">c_str</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error_code</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">StatusCode</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">OK</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Some error
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">grpc</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ClientContext</span>                                   <span style="color:#000">context</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionRequest</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">sdv</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">edge</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">comfort</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">seats</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">v1</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CurrentPositionReply</span>   <span style="color:#000">response</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">status_curr_pos</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">serviceClient</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">CurrentPosition</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;gRPC Server returned code: &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">status_curr_pos</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error_code</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;gRPC error message: &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">status_curr_pos</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error_message</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">c_str</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status_curr_pos</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">())</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;current Position:&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">seat</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">position</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">base</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="building-and-running">Building and Running</h2>
<p>To (re-)build the App after changing the code you can use the 

<a href="https://github.com/eclipse-velocitas/vehicle-app-cpp-template/blob/main/build.sh" target="_blank" rel="noopener">build script</a>
.
As preparation for running the client you must also set an environment variable to define the address/port of the server.
The environment variable needs to be set in the same terminal as used for starting the application.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./build.sh
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SDV_SEATS_ADDRESS</span><span style="color:#ce5c00;font-weight:bold">=</span>grpc://127.0.0.1:5555
</span></span></code></pre></div><p>If Databroker and the Server are running and have a valid value for the wanted signal, everything should work when the client is started.
Output similar to below is expected.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vscode ➜ /workspaces/erik_vapp_241018 <span style="color:#ce5c00;font-weight:bold">(</span>main<span style="color:#ce5c00;font-weight:bold">)</span> $ build/bin/app
</span></span><span style="display:flex;"><span>Starting
</span></span><span style="display:flex;"><span>gRPC Server returned code: <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>gRPC error message:
</span></span><span style="display:flex;"><span>gRPC Server returned code: <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>gRPC error message:
</span></span></code></pre></div>
</div>



    
	
  



          </main>
        </div>
      </div>
      


<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Eclipse Velocitas Project" aria-label="Eclipse Velocitas Project">
    <a class="text-white" target="_blank" rel="noopener" href="https://projects.eclipse.org/projects/automotive.velocitas" aria-label="Eclipse Velocitas Project">
      <i class="fas fa-external-link-alt"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://accounts.eclipse.org/mailing-list/velocitas-dev" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Gitter" aria-label="Gitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://app.gitter.im/#/room/#eclipse-velocitas_community:gitter.im" aria-label="Gitter">
      <i class="fab fa-gitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/velocitas_sdv" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/eclipse-velocitas" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer Meeting(s)" aria-label="Developer Meeting(s)">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/eclipse-velocitas/velocitas-docs/wiki/Developer-Meetup%28s%29" aria-label="Developer Meeting(s)">
      <i class="fa-solid fa-users"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2025 The Eclipse Velocitas™ Project. All Rights Reserved.</small>
        
        
      </div>
    </div>
    <div class="row">
      <div class="col-12 text-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org">
        Eclipse Foundation
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/privacy.php">
        Privacy Policy
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/termsofuse.php">
        Terms of Use
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/copyright.php">
        Copyright Agent
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/">
        Legal
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/epl-2.0/">
        License
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/security/">
        Report a Vulnerability
      </a>
    </small>
  </li>
  
</ul>

        
        
      </div>
  </div>
</footer>



    </div>
    <script src="/velocitas/js/main.min.f9eca5f1f43bad9da2925aded992fac79a8bfb4c7933cfd02992fb65f4543369.js" integrity="sha256-&#43;eyl8fQ7rZ2iklre2ZL6x5qL&#43;0x5M8/QKZL7ZfRUM2k=" crossorigin="anonymous"></script>
<script defer src="/velocitas/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/velocitas/js/tabpane-persist.js'></script>

  </body>
</html>
